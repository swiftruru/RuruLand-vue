/* Modern & Beautiful Print Styles for Resume/CV */
@media print {
  /* ========================================
     基礎設定
     ======================================== */
  * {
    -webkit-print-color-adjust: exact !important;
    print-color-adjust: exact !important;
    color-adjust: exact !important;
  }

  @page {
    margin: 2cm 1.5cm;
    size: A4 portrait;
  }

  body {
    font-family: 'Segoe UI', 'Helvetica Neue', Arial, sans-serif;
    font-size: 10pt;
    line-height: 1.6;
    color: #2c3e50;
    background: #ffffff;
    margin: 0;
    padding: 1.5cm !important;
  }

  /* ========================================
     隱藏非必要元素
     ======================================== */
  nav,
  .navbar,
  .nav-controls,
  .hamburger,
  .lang-switch,
  .nav-links,
  .resume-actions,
  .social-links,
  .social-share,
  footer,
  .page-loader,
  .accessibility-controls,
  .modal,
  .modal-overlay,
  button:not(.print-only),
  .animated-bg,
  .tape,
  .skill-category::before,
  .skill-category::after,
  .about .container::before,
  .about .container::after,
  .intro-text::before,
  .hero-buttons,
  .project-image,
  .contact-icon,
  canvas,
  #cursor-canvas {
    display: none !important;
  }

  /* 隱藏游標效果 */
  * {
    cursor: default !important;
  }

  /* ========================================
     容器與間距
     ======================================== */
  .container {
    max-width: 100% !important;
    width: 100% !important;
    margin: 0 !important;
    padding: 0 !important;
    box-shadow: none !important;
    border: none !important;
    background: transparent !important;
  }

  section {
    page-break-inside: auto;
    margin-bottom: 1.5rem;
    padding: 0 !important;
    background: transparent !important;
    display: block !important;
    visibility: visible !important;
    opacity: 1 !important;
  }

  /* 確保 Projects 和 Contact Section 顯示 */
  #projects,
  #contact,
  .projects,
  .contact {
    display: block !important;
    visibility: visible !important;
    opacity: 1 !important;
  }

  /* ========================================
     標題樣式
     ======================================== */
  h1, h2, h3, h4, h5, h6 {
    page-break-after: avoid;
    orphans: 3;
    widows: 3;
  }

  .section-title {
    font-size: 14pt;
    font-weight: 700;
    color: #1a5f3f;
    margin-bottom: 1rem;
    padding-bottom: 0.4rem;
    border-bottom: 2.5pt solid #1a5f3f;
    text-transform: uppercase;
    letter-spacing: 1pt;
    background: linear-gradient(to right, #e8f5e9 0%, transparent 100%) !important;
    padding: 0.3rem 0.5rem 0.3rem 0.5rem;
    margin-left: -0.5rem;
    margin-right: -0.5rem;
  }

  .section-title::after {
    display: none;
  }

  /* ========================================
     Hero Section (個人資訊) - 緊湊設計
     ======================================== */
  .hero {
    text-align: center;
    margin-bottom: 1rem;
    margin-top: 0;
    padding: 0 !important;
    page-break-after: auto;
    background: transparent !important;
    border: none !important;
  }

  .hero .container {
    background: linear-gradient(135deg, #e8f5e9 0%, #f1f8f4 100%) !important;
    border: 2pt solid #1a5f3f !important;
    border-radius: 4pt;
    padding: 0.8rem 1.5rem !important;
  }

  .hero-profile {
    margin-bottom: 0.5rem;
  }

  .profile-photo {
    width: 55pt;
    height: 55pt;
    margin: 0 auto;
    border-radius: 50%;
    border: 2.5pt solid #1a5f3f !important;
    display: block;
    filter: grayscale(20%) !important;
  }

  .hero h1 {
    font-size: 18pt;
    font-weight: 700;
    color: #1a5f3f;
    margin: 0 0 0.15rem 0;
    letter-spacing: 0.3pt;
  }

  .hero .hero-subtitle {
    font-size: 10pt;
    color: #2d7a52;
    font-weight: 500;
    margin: 0 0 0.4rem 0;
    font-style: italic;
  }

  .hero .hero-title {
    font-size: 11pt;
    font-weight: 600;
    color: #1a5f3f;
    margin: 0 0 0.3rem 0;
  }

  .hero .subtitle {
    font-size: 9pt;
    color: #2c3e50;
    margin: 0;
    line-height: 1.5;
  }

  /* ========================================
     About Section
     ======================================== */
  /* .about 的 page-break 規則已在上方統一設定 */

  .about-content {
    max-width: 100%;
  }

  .about-intro {
    margin-bottom: 1rem;
  }

  .intro-text {
    font-size: 9pt;
    line-height: 1.6;
    padding: 0.6rem 0.8rem !important;
    border-left: 4pt solid #2d7a52 !important;
    background: #f8fdf9 !important;
    border-radius: 0 2pt 2pt 0;
    color: #2c3e50;
    text-align: justify;
    margin: 0;
  }

  /* ========================================
     Skills Section (技能卡片)
     ======================================== */
  .skills-section {
    display: grid !important;
    grid-template-columns: repeat(2, 1fr) !important;
    gap: 0.6rem !important;
    margin-bottom: 0 !important;
  }

  .skill-category {
    padding: 0.6rem !important;
    border: 1.5pt solid #1a5f3f !important;
    border-radius: 3pt;
    page-break-inside: avoid;
    background: #ffffff !important;
  }

  .skill-category h3 {
    font-size: 10pt;
    font-weight: 700;
    color: #1a5f3f;
    margin-bottom: 0.5rem;
    padding-bottom: 0.3rem;
    border-bottom: 1pt solid #c8e6c9 !important;
  }

  .skill-category h3::after {
    display: none;
  }

  .tech-stack {
    display: flex;
    flex-wrap: wrap;
    gap: 0.3rem;
    margin-top: 0.5rem;
  }

  .tech-tag {
    display: inline-block;
    font-size: 8.5pt;
    padding: 0.15rem 0.5rem;
    border: 1pt solid #2d7a52 !important;
    border-radius: 10pt;
    background: #f1f8f4 !important;
    color: #1a5f3f;
    font-weight: 500;
    white-space: nowrap;
  }

  .experience-list {
    list-style: none;
    padding: 0;
    margin: 0;
  }

  .experience-list li {
    font-size: 9pt;
    padding: 0.35rem 0 0.35rem 1.5rem;
    position: relative;
    line-height: 1.6;
    color: #2c3e50;
  }

  .experience-list li::before {
    content: '✓';
    position: absolute;
    left: 0;
    font-weight: bold;
    color: #2d7a52;
    font-size: 11pt;
  }

  /* ========================================
     Projects Section
     ======================================== */
  /* .projects 的 page-break 規則已在上方統一設定 */

  .projects-grid {
    display: block !important;
  }

  .project-card {
    padding: 0.8rem !important;
    border: 1.5pt solid #c8e6c9 !important;
    border-left: 4pt solid #1a5f3f !important;
    border-radius: 2pt;
    page-break-inside: avoid;
    margin-bottom: 1rem;
    background: #ffffff !important;
  }

  .project-card:last-child {
    margin-bottom: 0;
  }

  .project-header {
    background: linear-gradient(135deg, #1a5f3f 0%, #2d7a52 100%) !important;
    padding: 0.8rem !important;
    border-radius: 2pt 2pt 0 0;
  }

  .project-title,
  .project-header h3 {
    font-size: 11pt;
    font-weight: 700;
    color: #ffffff !important;
    margin-bottom: 0.3rem;
  }

  .project-url {
    font-size: 8pt;
    color: #ffffff !important;
    display: block;
    margin-bottom: 0;
    word-break: break-all;
    font-weight: 600;
    text-decoration: none !important;
  }

  /* 查看網站按鈕 */
  .project-link,
  .overlay-link {
    background: #1a5f3f !important;
    color: #ffffff !important;
    border: 1.5pt solid #1a5f3f !important;
    padding: 0.4rem 1rem !important;
    border-radius: 15pt;
    font-weight: 600;
    text-decoration: none !important;
    display: inline-block;
  }

  .project-responsibilities,
  .project-tech-stack,
  .project-highlights {
    margin-bottom: 0.6rem;
  }

  .project-responsibilities:last-child,
  .project-tech-stack:last-child,
  .project-highlights:last-child {
    margin-bottom: 0;
  }

  .project-responsibilities h4,
  .project-tech-stack h4,
  .project-highlights h4 {
    font-size: 9.5pt;
    font-weight: 600;
    color: #2d7a52;
    margin-bottom: 0.3rem;
  }

  .project-responsibilities ul,
  .project-highlights ul {
    list-style: disc;
    margin-left: 1.2rem;
    font-size: 8.5pt;
    line-height: 1.6;
    color: #2c3e50;
    margin-top: 0.2rem;
    margin-bottom: 0;
  }

  .project-responsibilities li,
  .project-highlights li {
    margin-bottom: 0.15rem;
  }

  /* ========================================
     Contact Section
     ======================================== */
  /* .contact 的 page-break 規則已在上方統一設定 */

  .contact-intro {
    margin-bottom: 0.8rem;
  }

  .contact-intro p {
    font-size: 9pt;
    line-height: 1.6;
    margin: 0;
  }

  .contact-grid {
    display: grid !important;
    grid-template-columns: repeat(2, 1fr) !important;
    gap: 0.6rem !important;
  }

  .contact-item,
  .contact-card {
    padding: 0.6rem !important;
    border: 1.5pt solid #c8e6c9 !important;
    border-radius: 2pt;
    page-break-inside: avoid;
    background: #f8fdf9 !important;
  }

  .contact-item h3 {
    font-size: 9pt;
    font-weight: 700;
    color: #1a5f3f;
    margin-bottom: 0.3rem;
  }

  .contact-link,
  .contact-text {
    font-size: 9pt;
    color: #2c3e50;
    word-break: break-all;
    text-decoration: none;
  }

  .contact-label {
    font-size: 9pt;
    font-weight: 700;
    color: #1a5f3f;
    display: block;
    margin-bottom: 0.2rem;
  }

  .contact-value {
    font-size: 9pt;
    color: #2c3e50;
    word-break: break-all;
  }

  /* ========================================
     連結處理
     ======================================== */
  a {
    color: #2c3e50 !important;
    text-decoration: none !important;
  }

  /* 不顯示 URL */
  a::after {
    content: '' !important;
  }

  /* ========================================
     分頁控制
     ======================================== */
  h2, h3, h4, h5, h6 {
    orphans: 3;
    widows: 3;
  }

  p, li {
    orphans: 2;
    widows: 2;
  }

  /* ========================================
     頁首頁尾
     ======================================== */
  @page {
    @bottom-right {
      content: counter(page);
      font-size: 8pt;
      color: #666;
    }

    @bottom-center {
      content: 'Generated from Portfolio Website';
      font-size: 7pt;
      color: #999;
      font-style: italic;
    }
  }

  /* ========================================
     第一頁特殊處理
     ======================================== */
  body::before {
    display: none !important;
  }

  /* ========================================
     確保視覺一致性
     ======================================== */
  .about .container,
  .projects .container,
  .contact .container {
    background: transparent !important;
  }

  /* 強制顯示背景色和邊框 */
  .hero,
  .intro-text,
  .skill-category,
  .project-card,
  .contact-card,
  .tech-tag,
  .section-title {
    -webkit-print-color-adjust: exact !important;
    print-color-adjust: exact !important;
    color-adjust: exact !important;
  }

  /* ========================================
     優化間距
     ======================================== */
  #about {
    margin-bottom: 1rem !important;
  }

  #projects {
    margin-bottom: 1rem !important;
  }

  #contact {
    margin-bottom: 0.5rem !important;
  }

  /* ========================================
     確保內容不被截斷
     ======================================== */
  .skill-category,
  .project-card,
  .contact-card {
    break-inside: avoid;
    page-break-inside: avoid;
  }
}
